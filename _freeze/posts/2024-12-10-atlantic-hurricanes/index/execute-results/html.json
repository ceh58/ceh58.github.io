{
  "hash": "12ff760503d3b27ed62dc3544f008543",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hurricanes in the Atlantic\"\nsubtitle: \"An assessment of the factors driving the costs of hurricane damage.\"\nauthor:\n  - name: Carmen Hoyt\n    url: https://ceh58.github.io/\n    affiliation: Master of Environmental Data Science Program @ The Bren School (UCSB)\n    affiliation-url: https://ucsb-meds.github.io/ \ndate: last-modified\ncategories: [R, EDS222, Statistics]\nformat:\n  html:\n      toc: true\n      code-fold: true\nimage: thomas-fire.jpg\ndraft: false \neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n::: {.cell-output-display}\n![](hurricane.jpg)\n:::\n:::\n\n\n\nFor more information, visit my [GitHub Repository](https://github.com/ceh58/atlantic-hurricanes).\n\n# Introduction\n\nGrowing up on the Gulf Coast of Florida, my family and I were no strangers to hurricanes. We have lived in the same house for over 20 years, where some of my favorite hurricane memories included missing school, kayaking in the streets, and rushing our ice cream to our neighbor’s generator-powered freezer before it melted. However, recent hurricane seasons[^1] have brought a somber increase in flooding and severe damage. Storm preparations for many Floridians have changed from generally playful “hurricane parties” to fearful arrangements for evacuation, reflecting a dynamic shift in the severity of these events.\n\nClimate change is influencing natural disasters across the board, and hurricanes are no exception. While the frequency of storms is not projected to change, they are predicted to become more intense[^2]. Hurricane \"intensity\" is measured by the Saffir-Simpson scale[^3] in 5 categories based on wind speed. Storms assigned a category 3 or higher are considered \"major hurricanes,” expected to bring catastrophic damage (and thus more significant damage costs to the community).\n\n[^1]: Hurricane season runs June 1 to November 30, but since 2021, the [National Hurricane Center (NHC) has considered moving the start date to May 15](https://www.accuweather.com/en/hurricane/nhc-considering-change-to-start-date-of-hurricane-season/1168271) to encompass increasing early-season activity.\n\n[^2]: Read more about how hurricanes are expected to evolve with climate change [here](https://science.nasa.gov/earth/climate-change/a-force-of-nature-hurricanes-in-a-changing-climate/).\n\n[^3]: Read more about the Saffir-Simpson scale [here](https://www.weather.gov/mfl/saffirsimpson#:~:text=The%20Saffir%2DSimpson%20Hurricane%20Wind,loss%20of%20life%20and%20damage.).\n\nFor example, Hurricane Ian was a Category 5 storm that landed near Fort Myers, Florida in September 2022. It was the fifth-strongest hurricane to hit the contiguous U.S. and the third most expensive weather disaster worldwide at the time, totaling $113 billion in damages[^4]. This storm stands out as the worst to hit our neighborhood during my lifetime, bringing an unprecedented 7 feet of storm surge into our home. \n\n[^4]: Read more about Hurricane Ian [here](https://en.wikipedia.org/wiki/List_of_the_costliest_tropical_cyclones).\n\nMy personal observations and research on the topic lead me to my question: **as storms increase in intensity, are damage costs also being driven by time?**\n\nIn other words, are we seeing a rise in the damage costs associated with these natural disasters, and what can we expect in the future? To answer this question, I used Kaggle's [North American Hurricanes from 2000](https://www.kaggle.com/datasets/middlehigh/north-american-hurricanes-from-2000) dataset to develop a model of the factors driving hurricane damage costs. Of these factors, I predict that time affects damage costs (increasing over time).\n\nTo test this prediction, I establish a null (H0) and alternative (HA) hypotheses:\n\n- H0: Time has no effect on damage costs.\n- HA: Time has an effect on damage costs.\n\n# Methods\n\n## Import packages\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Load required packages\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(patchwork)\nlibrary(kableExtra)\nlibrary(webshot2)\nlibrary(here)\n```\n:::\n\n\n\nUsing the above R packages, I begin my analysis by investigating the NA values associated with damage costs (`damage_usd`). There are 14 in total, and they appear to be proportionally distributed among hurricane categories; so, I decide to remove them. \n\n## Import data\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Remove scientific notation\noptions(scipen=999)\n\n# Import hurricane data\nhurricane_data <- read_csv(here(\"posts/\", \"2024-12-10-atlantic-hurricanes/\", \"data/\", \"Hurricane Data.csv\"), show_col_types = FALSE) %>%\n  clean_names()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Total storms by category\ntotal_storms <- hurricane_data %>%\n  group_by(category) %>%\n  summarise(count = n()) %>%\n  rename(Category = category,\n         Count = count)\n\nprint(paste(\"There are\", sum(is.na(hurricane_data$damage_usd)), \"NA values associated with damage cost.\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"There are 14 NA values associated with damage cost.\"\n```\n\n\n:::\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Check NA values for damage (by category)\nna_storms <- hurricane_data %>%\n  filter(is.na(damage_usd))%>%\n  group_by(category) %>%\n  summarise(count = n()) %>%\n  rename(Category = category,\n         Count = count)\n\nna_table <- left_join(total_storms, na_storms, by = \"Category\") %>%\n  rename(\"Total Storms\" = Count.x,\n         \"NA Damage\" = Count.y) %>%\n  arrange(factor(Category, levels = c('TS', 'Category 1', 'Category 2', 'Category 3', 'Category 4', 'Category 5'))) %>%\n  kbl() %>%\n  kable_styling()\n\nna_table\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Category </th>\n   <th style=\"text-align:right;\"> Total Storms </th>\n   <th style=\"text-align:right;\"> NA Damage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> TS </td>\n   <td style=\"text-align:right;\"> 55 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Category 1 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Category 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Category 3 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Category 4 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Category 5 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nSince damage costs are reported as high as $140,000,000,000, I decided to scale the `damage_usd` column to represent millions of dollars and saved this variable as `damage_mil`. \n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Remove rows with NA values for damage costs\nhurricane_data_cleaned <- hurricane_data[!is.na(hurricane_data$damage_usd),]\n\n# Find total number of areas affected\nhurricane_data_cleaned <- hurricane_data_cleaned %>%\n  separate_longer_delim(affected_areas, \",\") %>%\n  group_by(year, name, category, rain_inch, highest_wind_speed, damage_usd, fatalities) %>%\n  summarise(total_areas = n()) %>%\n  # Scale down damage costs\n  mutate(damage_mil = damage_usd/1000000,\n         time = year - 2000)\n```\n:::\n\n\n\nTo test my hypothesis, I will need to calculate the regression coefficient (Beta) associated with time. In order to calculate this sample statistic, I need to develop a model for damage costs. I am primarily interested in the following variables from my dataset:\n\n- `year`: the year the storm occurred\n\n- `rain_inch`: rainfall (inches)\n\n- `highest_wind_speed`: max wind speed (mph)\n\n- `damage_usd`: damage costs in USD\n\n- `affected_areas`: list of places affected\n\nI chose these variables because they are characteristics of the storm that potentially have a relationship with storm damage costs. While variables such as “fatalities” are likely correlated with damage costs, they are more likely a *result* of storm intensity rather than a predictor. I also chose to forego `category` since we are already have a variable for wind speed.\n\nThe category 5 classification encompasses wind speeds of 157+ mph. As an open-ended category, increased damage costs may be associated with an increasing number of Category 5 storms. More storms will likely be classified as Category 5 due to increasing wind speeds (as a result of increasing storm intensity). So, max wind speed (`highest_wind_speed`) will likely be the most important predictor in my model. Since rainfall (`rain_inch`) intensity is also expected to increase with climate change, it will be crucial to include as well.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Wind speed over time\nwind_time <- ggplot(hurricane_data_cleaned, aes(x = year, y = highest_wind_speed)) +\n  geom_point() +\n  labs(x = \"Year\",\n       y = \"Max Wind Speed (mph)\",\n       title = \"Max Wind Speed over Time\") +\n  geom_hline(yintercept =157,\n             linetype = \"dashed\",\n             color = \"firebrick\") +\n  geom_smooth(method = \"lm\", se = FALSE, linewidth = 1, color = \"cornflowerblue\") +\n  theme_minimal()\n\n# Wind vs. damage\nwind_damage <- ggplot(hurricane_data_cleaned, aes(x = highest_wind_speed, y = damage_mil)) +\n  geom_point() +\n  labs(x = \"Max Wind Speed (mph)\",\n       y = \"Damage Costs (Millions of USD)\",\n       title = \"Damage Costs vs. Max Wind Speed\") +\n  geom_smooth(method = \"lm\", se = FALSE, linewidth = 1, color = \"cornflowerblue\") +\n  theme_minimal()\n\nwind_time / wind_damage\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n*You can see how the time period 2000-2014 had 2 category 5 storms while the time period 2015-2023 has 8.*\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Rainfall over time\nrain_time <- ggplot(hurricane_data_cleaned, aes(x = year, y = rain_inch)) +\n  geom_point() +\n  labs(x = \"Year\",\n       y = \"Rainfall (in)\",\n       title = \"Rainfall over Time\") +\n  geom_smooth(method = \"lm\", se = FALSE, linewidth = 1, color = \"cornflowerblue\") +\n  theme_minimal()\n\n# Rain vs. damage\nrain_damage <- ggplot(hurricane_data_cleaned, aes(x = rain_inch, y = damage_mil)) +\n  geom_point() +\n  labs(x = \"Rainfall (in)\",\n       y = \"Damage Costs (Millions of USD)\",\n       title = \"Damage Costs vs. Rainfall\") +\n  geom_smooth(method = \"lm\", se = FALSE, linewidth = 1, color = \"cornflowerblue\") +\n  theme_minimal()\n\nrain_time /rain_damage\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\nI created two new variables to include in the model. The first one measures the number of places affected, `total_areas`, calculated by counting how many \"areas\" are listed in the `areas_affected` column from the original dataset. While it seems intuitive that `total_areas` may increase over time, that isn’t the case (FIGURE?). However, there is still a relationship between `total_areas` and `damage_mill`, so we will include it. The last factor that I am interested in is time. Since we are looking at change over time, and 2000 is the start of the dataset, I calculated the `time` variable to be the number of years since 2000 that the storm occurred.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Number of places over time\nplaces_time <- ggplot(hurricane_data_cleaned, aes(x = year, y = total_areas)) +\n  geom_point() +\n  labs(x = \"Year\",\n       y = \"Number of Places Affected\",\n       title = \"Number of Places Affected over Time\") +\n  geom_smooth(method = \"lm\", se = FALSE, linewidth = 1, color = \"cornflowerblue\") +\n  theme_minimal()\n\n# Number of places vs. damage costs\nplaces_damage <- ggplot(hurricane_data_cleaned, aes(x = total_areas, y = damage_mil)) +\n  geom_point() +\n  labs(x = \"Number of Places Affected\",\n       y = \"Damage Costs (Millions of USD)\",\n       title = \"Damage Costs vs. Number of Places Affected\") +\n  geom_smooth(method = \"lm\", se = FALSE, linewidth = 1, color = \"cornflowerblue\") +\n  theme_minimal()\n\nplaces_time / places_damage\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Damage costs over time\nggplot(hurricane_data_cleaned, aes(x = time, y = damage_mil)) +\n  geom_point() +\n  labs(x = \"Time (Years since 2000)\",\n       y = \"Damage Costs (Millions of USD)\",\n       title = \"Damage Costs vs. Time\") +\n  geom_smooth(method = \"lm\", se = FALSE, linewidth = 1, color = \"cornflowerblue\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\nThe multiple regression equation that I settled on is:\n\n`damage_mil`~`highest_wind_speed` + `rain_inch` + `total_areas` + `time`\n\ndamage_mil = Beta 0 + Beta 1 * wind speed + Beta 2 * rainfall + Beta 3 * number of places affected + Beta 4 * time\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Create the model\ndamage_model <- lm(damage_mil ~ highest_wind_speed + rain_inch + total_areas + time, data = hurricane_data_cleaned)\nsummary(damage_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = damage_mil ~ highest_wind_speed + rain_inch + total_areas + \n    time, data = hurricane_data_cleaned)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-26812  -8091  -3670   3719  92553 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        -21877.43    5970.28  -3.664 0.000389 ***\nhighest_wind_speed    175.69      43.61   4.029 0.000106 ***\nrain_inch             610.73     215.81   2.830 0.005571 ** \ntotal_areas            70.82     604.22   0.117 0.906920    \ntime                  377.55     261.77   1.442 0.152163    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 18530 on 106 degrees of freedom\nMultiple R-squared:  0.2332,\tAdjusted R-squared:  0.2042 \nF-statistic: 8.057 on 4 and 106 DF,  p-value: 0.00001036\n```\n\n\n:::\n:::\n\n\n\nUsing this model, I calculated the regression coefficients (Beta 1, Beta 2, Beta 3, and Beta 4) and their associated p-values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# p-values\nbeta1_p <- summary(damage_model)$coefficients[2,4]\nbeta2_p <- summary(damage_model)$coefficients[3,4]\nbeta3_p <- summary(damage_model)$coefficients[4,4]\nbeta4_p <- summary(damage_model)$coefficients[5,4]\n\nbeta <- c(beta1_p, beta2_p, beta3_p, beta4_p)\n\n# Print p-values\nfor (i in seq_along(beta)) {\n  print(paste0(\"The p-value for Beta \", i, \" is \", beta[i], \".\"))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"The p-value for Beta 1 is 0.000105720738882069.\"\n[1] \"The p-value for Beta 2 is 0.00557054755522526.\"\n[1] \"The p-value for Beta 3 is 0.906919636226243.\"\n[1] \"The p-value for Beta 4 is 0.152163328387691.\"\n```\n\n\n:::\n:::\n\n\n\nTo visualize damage predictions by the model, I looked at damage costs over time by wind speeds (broken down by category) and by rainfall (by quantiles). To visualize damage predictions by wind speed, I held rainfall and total areas constant at their mean values. To visualize damage predictions by rainfall quantile, I held wind speed and total areas constant at their mean values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Update model\npredictions <- expand_grid(\n  highest_wind_speed = c(74, 96, 111, 130, 157),\n  rain_inch = mean(hurricane_data_cleaned$rain_inch),\n  total_areas = mean(hurricane_data_cleaned$total_areas),\n  time = seq(0, 23, length.out = 100)) %>%\n  mutate(damage_predicted = predict(damage_model, \n                                      newdata = .,\n                                      type = \"response\"))\n\n#Visualize\nggplot(predictions, aes(time, damage_predicted, color = factor(highest_wind_speed))) +\n  geom_line() +\n  scale_color_brewer(palette = \"Reds\",\n                     name =\"Wind Speed (mph)\",\n                   labels = c(\"74 (Cat 1)\", \"96 (Cat 2)\", \"111 (Cat 3)\", \"130 (Cat 4)\", \"157 (Cat 5)\")) +\n   labs(x = \"Years Since 2000\",\n       y = \"Predicted Damage Costs (Millions of USD)\",\n       title = \"Predicted Damage Costs over Time by Wind Speed\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Expand Code\"}\n# Update model\npredictions3 <- expand_grid(\n  highest_wind_speed = mean(hurricane_data_cleaned$highest_wind_speed),\n  rain_inch = c(quantile(hurricane_data_cleaned$rain_inch)[2],\n                   quantile(hurricane_data_cleaned$rain_inch)[3],\n                   quantile(hurricane_data_cleaned$rain_inch)[4]),\n  total_areas = mean(hurricane_data_cleaned$total_areas),\n  time = seq(0, 23, length.out = 100)) %>%\n  mutate(damage_predicted = predict(damage_model, \n                                      newdata = .,\n                                      type = \"response\"))\n\n# Visualize\nggplot(predictions3, aes(time, damage_predicted, color = factor(rain_inch))) +\n  geom_line() +\n  scale_color_brewer(palette = \"Reds\",\n                     name =\"Rainfall (in)\") +\n   labs(x = \"Years Since 2000\",\n       y = \"Predicted Damage Costs (Millions of USD)\",\n       title = \"Predicted Damage Costs over Time by Rainfall Quantiles\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n# Conclusions\n\nI found that the p-values for Beta 1 (`hightest_wind_speed`) and Beta 2 (`rain_inch`) were less than $alpha=0.05$. While we cannot confirm that `damage costs` are affected by `max wind speed` and `rainfall`, we can rule out that their influence is due to random chance. \n\nHowever, to answer my initial question, we must look at Beta 4. Both Beta 3 (`total_areas`) and Beta 4 (`time`) were greater than $alpha=0.05$. So, we fail to reject the null hypothesis for `time`: \n\n- H0: Time has no effect on storm damage costs.\n\nTo conclude, I could not rule out that the effect of `time` on `damage_mil` could be due to random chance. \n\nThere are more than a few limitations to this analysis. First and foremost, the cleaned dataset only includes 111 observations from a 23-year time period. It would be ideal to have more observations from a longer time range to asses how damage costs have changed over time. In addition to a limited time range, it was not clear the source of the data and how particular variables were calculated. For example, what determined whether or not a place was named in the list of `areas_affected`? How was total rainfall calculated? \n\nI also think there is omitted variable bias for inflation. Damage costs could be primarily driven by the rising costs of building materials or bubbles in the real estate market. \n\nAccording to the literature, variables such as storm surge and water temperature would be interesting predictor to include as they are expected to increase with storm intensity. \n\n## Next steps\n\nGiven more time, I would have been interested in compiling a better dataset. The dataset used in this analysis isn't the best (no original source or thorough descriptions of variables i.e. rainfall?).\n\nhttps://www.ncei.noaa.gov/access/billions/\n\n# References\n\nhttps://stock.adobe.com/search/images?k=hurricane",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}